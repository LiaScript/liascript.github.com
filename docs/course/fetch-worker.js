const CACHE_NAME="fetch-cache",MAX_CACHE_ITEMS=500;async function trimCache(e,t){const c=await caches.open(e),n=await c.keys();if(n.length>t)for(let e=0;e<n.length-t;e++)await c.delete(n[e])}self.addEventListener("fetch",(e=>{new URL(e.request.url).origin!==self.location.origin&&"GET"===e.request.method&&e.respondWith(fetch(e.request).then((t=>{const c=t.clone();return caches.open(CACHE_NAME).then((async t=>{await t.put(e.request,c),await trimCache(CACHE_NAME,500)})),t})).catch((()=>caches.match(e.request).then((e=>e||Promise.reject("no-match"))))))}));
