!function(){var n=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire55a5;n.register("1UDrq",(function(e,t){var r,a;r=e.exports,a=function(){return Ge},Object.defineProperty(r,"joinRoom",{get:a,set:undefined,enumerable:!0,configurable:!0});var u,o,i,c,f,s,l,d,v,p,y,h,g,b,m,w,k,A,_,T=n("hnmIs"),x=n("9Klpk"),P=n("3bWnf"),S=n("eT7f3"),E=n("bgoEC"),C=n("7j4mF"),U=n("5ENmm"),L=n("6Wo7Q"),D=n("rJmE6"),I=n("32Euv"),O={p:0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn,n:0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141n,h:1n,a:0n,b:7n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n},j=O.p,R=O.n,H=O.Gx,B=O.Gy,M=O.b,V=32,q=function(){var n=Error(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"");throw function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r;"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&(r=Error).captureStackTrace.apply(r,(0,L.default)(e))}(n,q),n},K=function(n,e){var t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=(t=n)instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name,u=null==n?void 0:n.length,o=void 0!==e;return(!a||o&&u!==e)&&q((r&&'"'.concat(r,'" '))+"expected Uint8Array"+(o?" of length "+e:"")+", got "+(a?"length="+u:"type="+(void 0===n?"undefined":(0,D.default)(n)))),n},Z=function(n){return new Uint8Array(n)},X=function(n,e){return n.toString(16).padStart(e,"0")},N=function(n){return Array.from(K(n)).map((function(n){return X(n,2)})).join("")},Y=function(n){return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void 0},G=function(n){var e="hex invalid";if("string"!=typeof n)return q(e);var t=n.length,r=t/2;if(t%2)return q(e);for(var a=Z(r),u=0,o=0;u<r;u++,o+=2){var i=Y(n.charCodeAt(o)),c=Y(n.charCodeAt(o+1));if(void 0===i||void 0===c)return q(e);a[u]=16*i+c}return a},J=function(){return null===globalThis||void 0===globalThis?void 0:globalThis.crypto},z=function(){var n;return null!==(_=null===(n=J())||void 0===n?void 0:n.subtle)&&void 0!==_?_:q("crypto.subtle must be defined, consider polyfill")},W=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=Z(e.reduce((function(n,e){return n+K(e).length}),0)),a=0;return e.forEach((function(n){r.set(n,a),a+=n.length})),r},F=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return J().getRandomValues(Z(n))},Q=BigInt,$=function(n,e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bad number: out of range";return function(n){return"bigint"==(void 0===n?"undefined":(0,D.default)(n))}(n)&&e<=n&&n<t?n:q(r)},nn=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,t=n%e;return t>=0n?t:e+t},en=function(n){return nn(n,R)},tn=function(n){return n instanceof sn?n:q("Point expected")},rn=function(n){return nn(nn(n*n)*n+M)},an=function(n){return $(n,0n,j)},un=function(n){return $(n,1n,j)},on=function(n){return 0n===(1n&n)},cn=function(n){return Uint8Array.of(n)},fn=function(n){for(var e=rn(un(n)),t=1n,r=e,a=(j+1n)/4n;a>0n;a>>=1n)1n&a&&(t=t*r%j),r=r*r%j;return nn(t*t)===e?t:q("sqrt invalid")},sn=function(){"use strict";function n(e,t,r){(0,x.default)(this,n),(0,S.default)(this,"X",void 0),(0,S.default)(this,"Y",void 0),(0,S.default)(this,"Z",void 0),this.X=an(e),this.Y=un(t),this.Z=an(r),Object.freeze(this)}return(0,P.default)(n,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"equals",value:function(n){var e=this,t=e.X,r=e.Y,a=e.Z,u=tn(n),o=u.X,i=u.Y,c=u.Z,f=nn(t*c),s=nn(o*a),l=nn(r*c),d=nn(i*a);return f===s&&l===d}},{key:"is0",value:function(){return this.equals(dn)}},{key:"negate",value:function(){return new n(this.X,nn(-this.Y),this.Z)}},{key:"double",value:function(){return this.add(this)}},{key:"add",value:function(e){var t=this,r=t.X,a=t.Y,u=t.Z,o=tn(e),i=o.X,c=o.Y,f=o.Z,s=0n,l=0n,d=0n,v=nn(3n*M),p=nn(r*i),y=nn(a*c),h=nn(u*f),g=nn(r+a),b=nn(i+c);g=nn(g*b),b=nn(p+y),g=nn(g-b),b=nn(r+u);var m=nn(i+f);return b=nn(b*m),m=nn(p+h),b=nn(b-m),m=nn(a+u),s=nn(c+f),m=nn(m*s),s=nn(y+h),m=nn(m-s),d=nn(0n*b),s=nn(v*h),d=nn(s+d),s=nn(y-d),d=nn(y+d),l=nn(s*d),y=nn(p+p),y=nn(y+p),h=nn(0n*h),b=nn(v*b),y=nn(y+h),h=nn(p-h),h=nn(0n*h),b=nn(b+h),p=nn(y*b),l=nn(l+p),p=nn(m*b),s=nn(g*s),s=nn(s-p),p=nn(g*y),d=nn(m*d),new n(s,l,d=nn(d+p))}},{key:"subtract",value:function(n){return this.add(tn(n).negate())}},{key:"multiply",value:function(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e&&0n===n)return dn;if(function(n){$(n,1n,R)}(n),1n===n)return this;if(this.equals(ln))return Zn(n).p;for(var t=dn,r=ln,a=this;n>0n;a=a.double(),n>>=1n)1n&n?t=t.add(a):e&&(r=r.add(a));return t}},{key:"multiplyUnsafe",value:function(n){return this.multiply(n,!1)}},{key:"toAffine",value:function(){var n=this,e=n.X,t=n.Y,r=n.Z;if(this.equals(dn))return{x:0n,y:0n};if(1n===r)return{x:e,y:t};var a=function(n,e){(0n===n||e<=0n)&&q("no inverse n="+n+" mod="+e);for(var t=nn(n,e),r=e,a=0n,u=1n;0n!==t;){var o=r%t,i=a-u*(r/t);r=t,t=o,a=u,u=i}return 1n===r?nn(a,e):q("no inverse")}(r,j);return 1n!==nn(r*a)&&q("inverse invalid"),{x:nn(e*a),y:nn(t*a)}}},{key:"assertValidity",value:function(){var n=this.toAffine(),e=n.x,t=n.y;return un(e),un(t),nn(t*t)===rn(e)?this:q("bad point: not on curve")}},{key:"toBytes",value:function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.assertValidity().toAffine(),t=e.x,r=e.y,a=wn(t);return n?W(function(n){return cn(on(n)?2:3)}(r),a):W(cn(4),a,wn(r))}},{key:"toHex",value:function(n){return N(this.toBytes(n))}}],[{key:"CURVE",value:function(){return O}},{key:"fromAffine",value:function(e){var t=e.x,r=e.y;return 0n===t&&0n===r?dn:new n(t,r,1n)}},{key:"fromBytes",value:function(e){K(e);var t,r=e.length,a=e[0],u=e.subarray(1),o=bn(u,0,V);if(33===r&&(2===a||3===a)){var i=fn(o),c=on(i);on(Q(a))!==c&&(i=nn(-i)),t=new n(o,i,1n)}return 65===r&&4===a&&(t=new n(o,bn(u,V,64),1n)),t?t.assertValidity():q("bad point: not on curve")}},{key:"fromHex",value:function(e){return n.fromBytes(G(e))}}]),n}();(0,S.default)(sn,"BASE",void 0),(0,S.default)(sn,"ZERO",void 0);var ln=new sn(H,B,1n),dn=new sn(0n,1n,0n);sn.BASE=ln,sn.ZERO=dn;var vn,pn,yn,hn,gn=function(n){return Q("0x"+(N(n)||"0"))},bn=function(n,e,t){return gn(n.subarray(e,t))},mn=Math.pow(2n,256n),wn=function(n){return G(X($(n,0n,mn),64))},kn="SHA-256",An={hmacSha256Async:function(n,e){return(0,T.default)((function(){var t,r,a;return(0,I.__generator)(this,(function(u){switch(u.label){case 0:return t=z(),r="HMAC",[4,t.importKey("raw",n,{name:r,hash:{name:kn}},!1,["sign"])];case 1:return a=u.sent(),[4,t.sign(r,a,e)];case 2:return[2,Z.apply(void 0,[u.sent()])]}}))}))()},hmacSha256:void 0,sha256Async:function(n){return(0,T.default)((function(){return(0,I.__generator)(this,(function(e){switch(e.label){case 0:return[4,z().digest(kn,n)];case 1:return[2,Z.apply(void 0,[e.sent()])]}}))}))()},sha256:void 0},_n=function(n){return Uint8Array.from("BIP0340/"+n,(function(n){return n.charCodeAt(0)}))},Tn="nonce",xn="challenge",Pn=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var a=function(n){var e=An[n];return"function"!=typeof e&&q("hashes."+n+" not set"),e}("sha256"),u=a(_n(n));return a(W.apply(void 0,[u,u].concat((0,L.default)(t))))},Sn=(vn=(0,T.default)((function(n){var e,t,r,a,u,o=arguments;return(0,I.__generator)(this,(function(i){switch(i.label){case 0:for(e=o.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=o[r];return[4,(a=An.sha256Async)(_n(n))];case 1:return u=i.sent(),[4,a(W.apply(void 0,[u,u].concat((0,L.default)(t))))];case 2:return[2,i.sent()]}}))})),function(n){return vn.apply(this,arguments)}),En=function(n){var e=function(n){var e=gn(K(n,V,"secret key"));return $(e,1n,R,"invalid secret key: outside of range")}(n),t=ln.multiply(e).assertValidity().toAffine(),r=t.x,a=t.y;return{d:on(a)?e:en(-e),px:wn(r)}},Cn=function(n){return en(gn(n))},Un=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return Cn(Pn.apply(void 0,[xn].concat((0,L.default)(e))))},Ln=function(){var n=(0,T.default)((function(){var n,e,t,r=arguments;return(0,I.__generator)(this,(function(a){switch(a.label){case 0:for(n=r.length,e=new Array(n),t=0;t<n;t++)e[t]=r[t];return[4,Sn.apply(void 0,[xn].concat((0,L.default)(e)))];case 1:return[2,Cn.apply(void 0,[a.sent()])]}}))}));return function(){return n.apply(this,arguments)}}(),Dn=function(n){return En(n).px},In=(pn=Dn,function(n){var e=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F(48);K(n),(n.length<48||n.length>1024)&&q("expected 40-1024b");var e=nn(gn(n),R-1n);return wn(e+1n)}(n);return{secretKey:e,publicKey:pn(e)}}),On=function(n,e,t){var r=En(e),a=r.px,u=r.d;return{m:K(n),px:a,d:u,a:K(t,V)}},jn=function(n){var e=Cn(n);0n===e&&q("sign failed: k is zero");var t=En(wn(e));return{rx:t.px,k:t.d}},Rn=function(n,e,t,r){return W(e,wn(en(n+t*r)))},Hn="invalid signature produced",Bn=function(n,e,t,r){var a,u,o=K(n,64,"signature"),i=K(e,void 0,"message"),c=K(t,V,"publicKey");try{var f=gn(c),s=fn(f),l=on(s)?s:nn(-s),d=new sn(f,l,1n).assertValidity(),v=wn(d.toAffine().x),p=bn(o,0,V);$(p,1n,j);var y=bn(o,V,64);return $(y,1n,R),a=r(W(wn(p),v,i)),u=function(n){var e,t,r,a=(e=d,t=y,r=en(-n),ln.multiply(t,!1).add(e.multiply(r,!1)).assertValidity()).toAffine(),u=a.x,o=a.y;return!(!on(o)||u!==p)},a instanceof Promise?a.then(u):u(a)}catch(n){return!1}},Mn=function(n,e,t){return Bn(n,e,t,Un)},Vn=function(){var n=(0,T.default)((function(n,e,t){return(0,I.__generator)(this,(function(r){return[2,Bn(n,e,t,Ln)]}))}));return function(e,t,r){return n.apply(this,arguments)}}(),qn={keygen:In,getPublicKey:Dn,sign:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F(V),r=On(n,e,t),a=r.m,u=r.px,o=r.d,i=r.a,c=Pn("aux",i),f=wn(o^gn(c)),s=Pn(Tn,f,u,a),l=jn(s),d=l.rx,v=l.k,p=Un(d,u,a),y=Rn(v,d,p,o);return Mn(y,a,u)||q(Hn),y},verify:Mn,signAsync:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F(V);return(0,T.default)((function(){var r,a,u,o,i,c,f,s,l,d,v,p,y;return(0,I.__generator)(this,(function(h){switch(h.label){case 0:return r=On(n,e,t),a=r.m,u=r.px,o=r.d,i=r.a,[4,Sn("aux",i)];case 1:return c=h.sent(),f=wn(o^gn(c)),[4,Sn(Tn,f,u,a)];case 2:return s=h.sent(),l=jn(s),d=l.rx,v=l.k,[4,Ln(d,u,a)];case 3:return p=h.sent(),y=Rn(v,d,p,o),[4,Vn(y,a,u)];case 4:return[2,(h.sent()||q(Hn),y)]}}))}))()},verifyAsync:Vn},Kn=function(n,e){var t=e.negate();return n?t:e},Zn=function(n){for(var e=yn||(yn=function(){for(var n=[],e=ln,t=e,r=0;r<33;r++){t=e,n.push(t);for(var a=1;a<128;a++)t=t.add(e),n.push(t);e=t.double()}return n}()),t=dn,r=ln,a=Q(255),u=Q(8),o=0;o<33;o++){var i=Number(n&a);n>>=u,i>128&&(i-=256,n+=1n);var c=128*o,f=c,s=c+Math.abs(i)-1,l=o%2!=0,d=i<0;0===i?r=r.add(Kn(l,e[f])):t=t.add(Kn(d,e[s]))}return 0n!==n&&q("invalid wnaf"),{p:t,f:r}},Xn=Math.floor,Nn=Math.random,Yn=Math.sin,Gn="Trystero",Jn=function(n,e){return Array(n).fill().map(e)},zn=function(n){return Jn(n,(function(){return"0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"[Xn(62*Nn())]})).join("")},Wn=zn(20),Fn=Promise.all.bind(Promise),Qn="undefined"!=typeof window,$n=Object.entries,ne=Object.fromEntries,ee=Object.keys,te=function(){},re=function(n){return Error("".concat(Gn,": ").concat(n))},ae=new TextEncoder,ue=new TextDecoder,oe=function(n){return ae.encode(n)},ie=function(n){return ue.decode(n)},ce=function(n){return n.reduce((function(n,e){return n+e.toString(16).padStart(2,"0")}),"")},fe=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.join("@")},se=JSON.stringify,le=JSON.parse,de=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return n.split("").reduce((function(n,e){return n+e.charCodeAt(0)}),0)%e},ve={},pe=null,ye=null,he=function(){pe||(pe=new Promise((function(n){ye=n})).finally((function(){ye=null,pe=null})))},ge=function(){return null==ye?void 0:ye()},be="AES-GCM",me={},we=function(){var n=(0,T.default)((function(n,e){var t;return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return t=Uint8Array.bind,[4,crypto.subtle.digest(n,oe(e))];case 1:return[2,new(t.apply(Uint8Array,[void 0,r.sent()]))]}}))}));return function(e,t){return n.apply(this,arguments)}}(),ke=function(){var n=(0,T.default)((function(n){var e,t;return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return(e=(u=me)[o=n])?[3,2]:(t=Array.from,[4,we("SHA-1",n)]);case 1:e=u[o]=t.apply(Array,[r.sent()]).map((function(n){return n.toString(36)})).join(""),r.label=2;case 2:return[2,e]}}))}));return function(e){return n.apply(this,arguments)}}(),Ae=function(){var n=(0,T.default)((function(n,e){var t,r,a,u,o,i;return(0,I.__generator)(this,(function(c){switch(c.label){case 0:return t=crypto.getRandomValues(new Uint8Array(16)),a=t.join(",")+"$",o=(u=crypto.subtle).encrypt,i=[{name:be,iv:t}],[4,n];case 1:return[4,o.apply(u,i.concat([c.sent(),oe(e)]))];case 2:return[2,a+(r=c.sent(),btoa(String.fromCharCode.apply(null,new Uint8Array(r))))]}}))}));return function(e,t){return n.apply(this,arguments)}}(),_e=function(){var n=(0,T.default)((function(n,e){var t,r,a,u,o,i;return(0,I.__generator)(this,(function(c){switch(c.label){case 0:return t=(0,U.default)(e.split("$"),2),r=t[0],a=t[1],o=(u=crypto.subtle).decrypt,i=[{name:be,iv:new Uint8Array(r.split(","))}],[4,n];case 1:return[4,o.apply(u,i.concat([c.sent(),function(n){var e=atob(n);return new Uint8Array(e.length).map((function(n,t){return e.charCodeAt(t)})).buffer}(a)]))];case 2:return[2,ie.apply(void 0,[c.sent()])]}}))}));return function(e,t){return n.apply(this,arguments)}}(),Te="icegatheringstatechange",xe="offer",Pe=function(n,e){var t=e.rtcConfig,r=e.rtcPolyfill,a=e.turnConfig,u=new(r||RTCPeerConnection)((0,E.default)({iceServers:Se.concat(a||[])},t)),o={},i=!1,c=!1,f=null,s=function(n){n.binaryType="arraybuffer",n.bufferedAmountLowThreshold=65535,n.onmessage=function(n){var e;return null===(e=o.data)||void 0===e?void 0:e.call(o,n.data)},n.onopen=function(){var n;return null===(n=o.connect)||void 0===n?void 0:n.call(o)},n.onclose=function(){var n;return null===(n=o.close)||void 0===n?void 0:n.call(o)},n.onerror=function(n){var e;return null===(e=o.error)||void 0===e?void 0:e.call(o,n)}},l=function(n){return Promise.race([new Promise((function(e){var t=function(){"complete"===n.iceGatheringState&&(n.removeEventListener(Te,t),e())};n.addEventListener(Te,t),t()})),new Promise((function(n){return setTimeout(n,5e3)}))]).then((function(){return{type:n.localDescription.type,sdp:n.localDescription.sdp.replace(/a=ice-options:trickle\s\n/g,"")}}))};return n?(f=u.createDataChannel("data"),s(f)):u.ondatachannel=function(n){var e=n.channel;f=e,s(e)},u.onnegotiationneeded=(0,T.default)((function(){var n,e,t,r;return(0,I.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,4,5]),i=!0,[4,u.setLocalDescription()];case 1:return a.sent(),[4,l(u)];case 2:return e=a.sent(),null===(n=o.signal)||void 0===n||n.call(o,e),[3,5];case 3:return t=a.sent(),null===(r=o.error)||void 0===r||r.call(o,t),[3,5];case 4:return i=!1,[7];case 5:return[2]}}))})),u.onconnectionstatechange=function(){var n;["disconnected","failed","closed"].includes(u.connectionState)&&(null===(n=o.close)||void 0===n||n.call(o))},u.ontrack=function(n){var e,t;null===(e=o.track)||void 0===e||e.call(o,n.track,n.streams[0]),null===(t=o.stream)||void 0===t||t.call(o,n.streams[0])},u.onremovestream=function(n){var e;return null===(e=o.stream)||void 0===e?void 0:e.call(o,n.stream)},n&&(u.canTrickleIceCandidates||u.onnegotiationneeded()),{created:Date.now(),connection:u,get channel(){return f},get isDead(){return"closed"===u.connectionState},signal:function(e){return(0,T.default)((function(){var t,r,a,s,d;return(0,I.__generator)(this,(function(v){switch(v.label){case 0:if("open"===(null==f?void 0:f.readyState)&&!(null===(t=e.sdp)||void 0===t?void 0:t.includes("a=rtpmap")))return[3,14];v.label=1;case 1:return v.trys.push([1,13,,14]),e.type!==xe?[3,8]:i||"stable"!==u.signalingState&&!c?n?[2]:[4,Fn([u.setLocalDescription({type:"rollback"}),u.setRemoteDescription(e)])]:[3,3];case 2:return v.sent(),[3,5];case 3:return[4,u.setRemoteDescription(e)];case 4:v.sent(),v.label=5;case 5:return[4,u.setLocalDescription()];case 6:return v.sent(),[4,l(u)];case 7:return a=v.sent(),[2,(null===(r=o.signal)||void 0===r||r.call(o,a),a)];case 8:if("answer"!==e.type)return[3,12];c=!0,v.label=9;case 9:return v.trys.push([9,,11,12]),[4,u.setRemoteDescription(e)];case 10:return v.sent(),[3,12];case 11:return c=!1,[7];case 12:return[3,14];case 13:return s=v.sent(),null===(d=o.error)||void 0===d||d.call(o,s),[3,14];case 14:return[2]}}))}))()},sendData:function(n){return f.send(n)},destroy:function(){null==f||f.close(),u.close(),i=!1,c=!1},setHandlers:function(n){return Object.assign(o,n)},offerPromise:n?new Promise((function(n){return o.signal=function(e){e.type===xe&&n(e)}})):Promise.resolve(),addStream:function(n){return n.getTracks().forEach((function(e){return u.addTrack(e,n)}))},removeStream:function(n){return u.getSenders().filter((function(e){return n.getTracks().includes(e.track)})).forEach((function(n){return u.removeTrack(n)}))},addTrack:function(n,e){return u.addTrack(n,e)},removeTrack:function(n){var e=u.getSenders().find((function(e){return e.track===n}));e&&u.removeTrack(e)},replaceTrack:function(n,e){var t=u.getSenders().find((function(e){return e.track===n}));if(t)return t.replaceTrack(e)}}},Se=(0,L.default)(Jn(3,(function(n,e){return"stun:stun".concat(e||"",".l.google.com:19302")}))).concat(["stun:stun.cloudflare.com:3478"]).map((function(n){return{urls:n}})),Ee=Object.getPrototypeOf(Uint8Array),Ce=16369,Ue=255,Le="bufferedamountlow",De=function(n){return"@_"+n},Ie={},Oe="EVENT",je=qn.keygen(),Re=je.secretKey,He=je.publicKey,Be=ce(He),Me={},Ve={},qe={},Ke=function(){return Math.floor(Date.now()/1e3)},Ze=function(n){return null!==(hn=(y=qe)[h=n])&&void 0!==hn?hn:y[h]=de(n,1e4)+2e4},Xe=function(){var n=(0,T.default)((function(n,e){var t,r,a,u,o;return(0,I.__generator)(this,(function(i){switch(i.label){case 0:return t={kind:Ze(n),tags:[["x",n]],created_at:Ke(),content:e,pubkey:Be},[4,we("SHA-256",se([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))];case 1:return r=i.sent(),a=[Oe],u=[(0,E.default)({},t)],o={id:ce(r)},[4,qn.signAsync(r,Re)];case 2:return[2,se.apply(void 0,[a.concat([C.default.apply(void 0,u.concat([(o.sig=ce.apply(void 0,[i.sent()]),o)]))])])]}}))}));return function(e,t){return n.apply(this,arguments)}}(),Ne=function(n,e){return Me[n]=e,se(["REQ",n,{kinds:[Ze(e)],since:Ke(),"#x":[e]}])},Ye=function(n){return delete Me[n],se(["CLOSE",n])},Ge=function(n){var e,t,r,a,u=n.init,o=n.subscribe,y=n.announce,h={},k=!1;return function(n,A,_){var x,P,S=n.appId;if(null===(P=h[S])||void 0===P?void 0:P[A])return h[S][A];var O={},j={},R=fe(Gn,S,A),H=ke(R),B=ke(fe(R,Wn)),M=function(){var n=(0,T.default)((function(n,e,t){var r,a,u;return(0,I.__generator)(this,(function(o){switch(o.label){case 0:return a=(r=crypto.subtle).importKey,u=["raw"],[4,crypto.subtle.digest({name:"SHA-256"},oe("".concat(n,":").concat(e,":").concat(t)))];case 1:return[2,a.apply(r,u.concat([o.sent(),{name:be},!1,["encrypt","decrypt"]]))]}}))}));return function(e,t,r){return n.apply(this,arguments)}}()(n.password||"",S,A),V=function(n){return function(){var e=(0,T.default)((function(e){var t;return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return t={type:e.type},[4,n(M,e.sdp)];case 1:return[2,(t.sdp=r.sent(),t)]}}))}));return function(n){return e.apply(this,arguments)}}()},q=V(_e),K=V(Ae),Z=function(){return Pe(!0,n)},X=function(n,e,t){var r;j[e]?j[e]!==n&&n.destroy():(j[e]=n,$(n,e),null===(r=O[e])||void 0===r||r.forEach((function(n,e){e!==t&&n.destroy()})),delete O[e])},N=function(n,e){j[e]===n&&delete j[e]},Y=function(n){return(x=t).push.apply(x,(0,L.default)(Jn(n,Z))),Fn(t.splice(0,n).map((function(n){return n.offerPromise.then(K).then((function(e){return{peer:n,offer:e}}))})))},G=function(e,t){return null==_?void 0:_({error:"incorrect password (".concat(n.password,") when decrypting ").concat(t),appId:S,peerId:e,roomId:A})},J=function(e){return function(){var t=(0,T.default)((function(t,r,a){var u,o,i,c,f,s,l,d,v,p,y,h,m,w,k,A,_,T,x,P,S,E,C,L,D,M;return(0,I.__generator)(this,(function(I){switch(I.label){case 0:return[4,Fn([H,B])];case 1:if(u=U.default.apply(void 0,[I.sent(),2]),o=u[0],i=u[1],t!==o&&t!==i)return[2];if(c="string"==typeof r?le(r):r,f=c.peerId,s=c.offer,l=c.answer,d=c.peer,f===Wn||j[f])return[3,16];if(f&&!s&&!l)return[3,14];if(!s)return[3,8];if((null===(v=O[f])||void 0===v?void 0:v[e])&&Wn>f)return[2];(p=Pe(!1,n)).setHandlers({connect:function(){return X(p,f,e)},close:function(){return N(p,f)}}),I.label=2;case 2:return I.trys.push([2,4,,5]),[4,q(s)];case 3:return y=I.sent(),[3,5];case 4:return I.sent(),[2,void G(f,"offer")];case 5:return p.isDead?[2]:[4,Fn([ke(fe(R,f)),p.signal(y)])];case 6:return h=U.default.apply(void 0,[I.sent(),2]),m=h[0],w=h[1],k=[m],A={peerId:Wn},[4,K(w)];case 7:return a.apply(void 0,k.concat([se.apply(void 0,[(A.answer=I.sent(),A)])])),[3,13];case 8:if(!l)return[3,13];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,q(l)];case 10:return _=I.sent(),[3,12];case 11:return I.sent(),[2,void G(f,"answer")];case 12:d?(d.setHandlers({connect:function(){return X(d,f,e)},close:function(){return N(d,f)}}),d.signal(_)):(x=null===(T=O[f])||void 0===T?void 0:T[e])&&!x.isDead&&x.signal(_),I.label=13;case 13:return[3,16];case 14:return(null===(P=O[f])||void 0===P?void 0:P[e])?[2]:[4,Fn([Y(1),ke(fe(R,f))])];case 15:S=U.default.apply(void 0,[I.sent(),2]),E=(0,U.default)(S[0],1),C=E[0],L=C.peer,D=C.offer,M=S[1],(g=O)[b=f]||(g[b]=[]),O[f][e]=L,setTimeout((function(){return function(n,e){var t;if(!j[n]){var r=null===(t=O[n])||void 0===t?void 0:t[e];r&&(delete O[n][e],r.destroy())}}(f,e)}),.9*W[e]),L.setHandlers({connect:function(){return X(L,f,e)},close:function(){return N(L,f)}}),a(M,se({peerId:Wn,offer:D})),I.label=16;case 16:return[2]}}))}));return function(n,e,r){return t.apply(this,arguments)}}()};if(!n)throw re("requires a config map as the first argument");if(!S&&!n.firebaseApp)throw re("config map is missing appId field");if(!A)throw re("roomId argument required");if(!k){var z=u(n);t=Jn(20,Z),e=Array.isArray(z)?z:[z],k=!0,r=setInterval((function(){return t=t.filter((function(n){var e=Date.now()-n.created<57333;return e||n.destroy(),e}))}),59052.99),a=n.manualRelayReconnection?te:function(){if(Qn){var n=new AbortController;return addEventListener("online",ge,{signal:n.signal}),addEventListener("offline",he,{signal:n.signal}),function(){return n.abort()}}return te}()}var W=e.map((function(){return 5333})),F=[],Q=e.map(function(){var n=(0,T.default)((function(n,e){var t;return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return[4,n];case 1:return t=[r.sent()],[4,H];case 2:return t=t.concat(r.sent()),[4,B];case 3:return[2,o.apply(void 0,t.concat([r.sent(),J(e),Y]))]}}))}));return function(e,t){return n.apply(this,arguments)}}());Fn([H,B]).then((function(n){var t=(0,U.default)(n,2),r=t[0],a=t[1],u=function(){var n=(0,T.default)((function(n,e){var t;return(0,I.__generator)(this,(function(o){switch(o.label){case 0:return[4,y(n,r,a)];case 1:return"number"==typeof(t=o.sent())&&(W[e]=t),F[e]=setTimeout((function(){return u(n,e)}),W[e]),[2]}}))}));return function(e,t){return n.apply(this,arguments)}}();Q.forEach(function(){var n=(0,T.default)((function(n,t){return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return[4,n];case 1:return r.sent(),[4,e[t]];case 2:return u.apply(void 0,[r.sent(),t]),[2]}}))}));return function(e,t){return n.apply(this,arguments)}}())}));var $=te;return(m=h)[w=S]||(m[w]={}),h[S][A]=function(n,e,t){var r={},a={},u={},o={},y={},h={},g={},b={onPeerJoin:te,onPeerLeave:te,onPeerStream:te,onPeerTrack:te},m=function(n,e){return(n?Array.isArray(n)?n:[n]:ee(r)).flatMap((function(n){var t=r[n];return t?e(n,t):(console.warn("".concat(Gn,": no peer with id ").concat(n," found")),[])}))},w=function(n){r[n]&&(r[n].destroy(),delete r[n],delete o[n],delete y[n],b.onPeerLeave(n),e(n))},k=function(n){if(a[n])return u[n];if(!n)throw re("action type argument is required");var e=oe(n);if(e.byteLength>12)throw re('action type string "'.concat(n,'" (').concat(e.byteLength,"b) exceeds byte limit (12). Hint: choose a shorter name."));var t=new Uint8Array(12);t.set(e);var o=0;return a[n]={onComplete:te,onProgress:te,setOnComplete:function(e){return a[n]=(0,C.default)((0,E.default)({},a[n]),{onComplete:e})},setOnProgress:function(e){return a[n]=(0,C.default)((0,E.default)({},a[n]),{onProgress:e})},send:function(n,e,a,u){return(0,T.default)((function(){var i,c,f,s,l,d,v,p,y,h,g;return(0,I.__generator)(this,(function(b){switch(b.label){case 0:if(a&&"object"!=typeof a)throw re("action meta argument must be an object");if("undefined"===(i=void 0===n?"undefined":(0,D.default)(n)))throw re("action data cannot be undefined");if(c="string"!==i,f=n instanceof Blob,s=f||n instanceof ArrayBuffer||n instanceof Ee,a&&!s)throw re("action meta argument can only be used with binary data");return s?(h=Uint8Array.bind,f?[4,n.arrayBuffer()]:[3,2]):[3,4];case 1:return g=b.sent(),[3,3];case 2:g=n,b.label=3;case 3:return y=new(h.apply(Uint8Array,[void 0,g])),[3,5];case 4:y=oe(c?se(n):n),b.label=5;case 5:return l=y,d=a?oe(se(a)):null,v=Math.ceil(l.byteLength/Ce)+(a?1:0)||1,p=Jn(v,(function(n,e){var r=e===v-1,u=a&&0===e,i=new Uint8Array(15+(u?d.byteLength:r?l.byteLength-Ce*(v-(a?2:1)):Ce));return i.set(t),i.set([o],12),i.set([r|u<<1|s<<2|c<<3],13),i.set([Math.round((e+1)/v*Ue)],14),i.set(a?u?d:l.subarray((e-1)*Ce,e*Ce):l.subarray(e*Ce,(e+1)*Ce),15),i})),[2,(o=o+1&Ue,Fn(m(e,function(){var n=(0,T.default)((function(n,e){var t,o,i;return(0,I.__generator)(this,(function(c){switch(c.label){case 0:t=e.channel,o=0,c.label=1;case 1:return o<v?(i=p[o],t.bufferedAmount>t.bufferedAmountLowThreshold?[4,new Promise((function(n){var e=function(){t.removeEventListener(Le,e),n()};t.addEventListener(Le,e)}))]:[3,3]):[3,5];case 2:c.sent(),c.label=3;case 3:if(!r[n])return[3,5];e.sendData(i),o++,null==u||u(i[14]/Ue,n,a),c.label=4;case 4:return[3,1];case 5:return[2]}}))}));return function(e,t){return n.apply(this,arguments)}}())))]}}))}))()}},(i=u)[c=n]||(i[c]=[a[n].send,a[n].setOnComplete,a[n].setOnProgress])},A=function(){var n=(0,T.default)((function(){return(0,I.__generator)(this,(function(n){switch(n.label){case 0:return[4,N("")];case 1:return n.sent(),[4,new Promise((function(n){return setTimeout(n,99)}))];case 2:return n.sent(),$n(r).forEach((function(n){var e=(0,U.default)(n,2),t=e[0];e[1].destroy(),delete r[t]})),t(),[2]}}))}));return function(){return n.apply(this,arguments)}}(),_=(0,U.default)(k(De("ping")),2),x=_[0],P=_[1],S=(0,U.default)(k(De("pong")),2),L=S[0],O=S[1],j=(0,U.default)(k(De("signal")),2),R=j[0],H=j[1],B=(0,U.default)(k(De("stream")),2),M=B[0],V=B[1],q=(0,U.default)(k(De("track")),2),K=q[0],Z=q[1],X=(0,U.default)(k(De("leave")),2),N=X[0],Y=X[1];return function(n){$=n}((function(n,e){r[e]||(r[e]=n,n.setHandlers({data:function(n){return function(n,e){var t=new Uint8Array(e),r=ie(t.subarray(0,12)).replaceAll("\0",""),u=(0,U.default)(t.subarray(12,13),1)[0],i=(0,U.default)(t.subarray(13,14),1)[0],c=(0,U.default)(t.subarray(14,15),1)[0],y=t.subarray(15),h=!!(1&i),g=!!(2&i),b=!!(4&i),m=!!(8&i);if(a[r]){(f=o)[s=n]||(f[s]={}),(l=o[n])[d=r]||(l[d]={});var w=(v=o[n][r])[p=u]||(v[p]={chunks:[]});if(g?w.meta=le(ie(y)):w.chunks.push(y),a[r].onProgress(c/Ue,n,w.meta),h){var k=new Uint8Array(w.chunks.reduce((function(n,e){return n+e.byteLength}),0));if(w.chunks.reduce((function(n,e){return k.set(e,n),n+e.byteLength}),0),delete o[n][r][u],b)a[r].onComplete(k,n,w.meta);else{var A=ie(k);a[r].onComplete(m?le(A):A,n)}}}else console.warn("".concat(Gn,": received message with unregistered type (").concat(r,")"))}(e,n)},stream:function(n){b.onPeerStream(n,e,h[e]),delete h[e]},track:function(n,t){b.onPeerTrack(n,t,e,g[e]),delete g[e]},signal:function(n){return R(n,e)},close:function(){return w(e)},error:function(n){console.error(n),w(e)}}),b.onPeerJoin(e))})),P((function(n,e){return L("",e)})),O((function(n,e){var t;null===(t=y[e])||void 0===t||t.call(y),delete y[e]})),H((function(n,e){var t;return null===(t=r[e])||void 0===t?void 0:t.signal(n)})),V((function(n,e){return h[e]=n})),Z((function(n,e){return g[e]=n})),Y((function(n,e){return w(e)})),Qn&&addEventListener("beforeunload",A),{makeAction:k,leave:A,ping:function(n){return(0,T.default)((function(){var e;return(0,I.__generator)(this,(function(t){switch(t.label){case 0:if(!n)throw re("ping() must be called with target peer ID");return e=Date.now(),x("",n),[4,new Promise((function(e){return y[n]=e}))];case 1:return[2,(t.sent(),Date.now()-e)]}}))}))()},getPeers:function(){return ne($n(r).map((function(n){var e=(0,U.default)(n,2);return[e[0],e[1].connection]})))},addStream:function(n,e,t){return m(e,function(){var e=(0,T.default)((function(e,r){return(0,I.__generator)(this,(function(a){switch(a.label){case 0:return t?[4,M(t,e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r.addStream(n),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}())},removeStream:function(n,e){return m(e,(function(e,t){return t.removeStream(n)}))},addTrack:function(n,e,t,r){return m(t,function(){var t=(0,T.default)((function(t,a){return(0,I.__generator)(this,(function(u){switch(u.label){case 0:return r?[4,K(r,t)]:[3,2];case 1:u.sent(),u.label=2;case 2:return a.addTrack(n,e),[2]}}))}));return function(n,e){return t.apply(this,arguments)}}())},removeTrack:function(n,e){return m(e,(function(e,t){return t.removeTrack(n)}))},replaceTrack:function(n,e,t,r){return m(t,function(){var t=(0,T.default)((function(t,a){return(0,I.__generator)(this,(function(u){switch(u.label){case 0:return r?[4,K(r,t)]:[3,2];case 1:u.sent(),u.label=2;case 2:return a.replaceTrack(n,e),[2]}}))}));return function(n,e){return t.apply(this,arguments)}}())},onPeerJoin:function(n){return b.onPeerJoin=n},onPeerLeave:function(n){return b.onPeerLeave=n},onPeerStream:function(n){return b.onPeerStream=n},onPeerTrack:function(n){return b.onPeerTrack=n}}}(0,(function(n){return delete j[n]}),(function(){delete h[S][A],F.forEach(clearTimeout),Q.forEach(function(){var n=(0,T.default)((function(n){return(0,I.__generator)(this,(function(e){switch(e.label){case 0:return[4,n];case 1:return[2,e.sent()()]}}))}));return function(e){return n.apply(this,arguments)}}()),clearInterval(r),a(),k=!1}))}}({init:function(n){return function(n,e,t){return(n.relayUrls||function(n,e){for(var t=(0,L.default)(n),r=function(){var n=1e4*Yn(e++);return n-Xn(n)},a=t.length;a;){var u,o=Xn(r()*a--);u=[t[o],t[a]],t[a]=u[0],t[o]=u[1]}return t}(e,de(n.appId))).slice(0,n.relayUrls?n.relayUrls.length:n.relayRedundancy||5)}(n,Je).map((function(n){var e=function(n,e){var t={},r=function(){var a=new WebSocket(n);a.onclose=function(){var e;pe?pe.then(r):(null!==(e=(k=ve)[A=n])&&void 0!==e||(k[A]=3333),setTimeout(r,ve[n]),ve[n]*=2)},a.onmessage=function(n){return e(n.data)},t.socket=a,t.url=a.url,t.ready=new Promise((function(e){return a.onopen=function(){e(t),ve[n]=3333}})),t.send=function(n){1===a.readyState&&a.send(n)}};return r(),t}(n,(function(n){var t,r=(0,U.default)(le(n),4),a=r[0],u=r[1],o=r[2],i=r[3];if(a===Oe)null===(t=Ve[u])||void 0===t||t.call(Ve,Me[u],o.content);else{var c="".concat(Gn,": relay failure from ").concat(e.url," - ");"NOTICE"===a?console.warn(c+u):"OK"!==a||o||console.warn(c+i)}}));return Ie[n]=e,e.ready}))},subscribe:function(n,e,t,r){var a=zn(64),u=zn(64);return Ve[a]=Ve[u]=function(e,t){return r(e,t,function(){var e=(0,T.default)((function(e,t){var r;return(0,I.__generator)(this,(function(a){switch(a.label){case 0:return r=n.send,[4,Xe(e,t)];case 1:return[2,r.apply(n,[a.sent()])]}}))}));return function(n,t){return e.apply(this,arguments)}}())},n.send(Ne(a,e)),n.send(Ne(u,t)),function(){n.send(Ye(a)),n.send(Ye(u)),delete Ve[a],delete Ve[u]}},announce:function(n,e){return(0,T.default)((function(){var t;return(0,I.__generator)(this,(function(r){switch(r.label){case 0:return t=n.send,[4,Xe(e,se({peerId:Wn}))];case 1:return[2,t.apply(n,[r.sent()])]}}))}))()}}),Je=(Ie,["black.nostrcity.club","ftp.halifax.rwth-aachen.de/nostr","nos.lol","nostr.cool110.xyz","nostr.data.haus","nostr.sathoarder.com","nostr.vulpem.com","relay.agorist.space","relay.binaryrobot.com","relay.damus.io","relay.fountain.fm","relay.mostro.network","relay.nostraddress.com","relay.nostrdice.com","relay.nostromo.social","relay.oldenburg.cool","relay.verified-nostr.com","yabu.me/v2"].map((function(n){return"wss://"+n})))}))}();
